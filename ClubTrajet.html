<!DOCTYPE html>
<html>
<head>
<meta content="yes" name="apple-mobile-web-app-capable" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta content="minimum-scale=1.0, width=device-width, maximum-scale=0.6667, user-scalable=no" name="viewport" />
<meta name="format-detection" content="telephone=no" />
<link href="favicon.ico" rel="icon" />
<link href="favicon.ico" rel="shortcut icon" />
<link href="favicon.ico" rel="apple-touch-icon" />
<link href="favicon.ico" rel="apple-touch-startup-image" />
<title>Golfs du Qu&eacute;bec</title>
<meta content="Golf GPS, Qu&eacute;bec, Canada, Golf du Qu&eacute;bec, Clubs de golf au Qu&eacute;bec, Qu&eacute;bec golf" name="keywords" />
<meta content="R&eacute;pertoire des clubs de golf du Qu&eacute;bec. GPS golf." name="description" />
<link href="misc/init.css" rel="stylesheet" media="screen" type="text/css" />
<link href="misc/format.css" rel="stylesheet" media="screen" type="text/css" />

    <script type="text/javascript" 
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA15nyiYmWG_0IkG9H5r4Qc8KhZxwRw_xA&sensor=false"> 
    </script> 

	<script type="text/javascript" src="misc/util.js"></script>
    <script type="text/javascript"> 
	<!--

var userId, myPos, golfPos, strClubLat, strClubLng, strClubNom;


var rendererOptions = {
  draggable: false
};
var directionsDisplay = new google.maps.DirectionsRenderer(rendererOptions);;
var directionsService = new google.maps.DirectionsService();
var map;
var golfMarker;

function stopGolfDrag(){
setDestination();
}

function initialize() {

  var mapOptions = {

		  panControl: false,    
		  zoomControl: false, 	  
		  scaleControl: false,
		  streetViewControl: false,
		  mapTypeControl: true,    
		  mapTypeControlOptions: {        
		  style: google.maps.MapTypeControlStyle.DROPDOWN_MENU    },
          mapTypeId: google.maps.MapTypeId.HYBRID,
    center: myPos
  };
  map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);
  directionsDisplay.setMap(map);
  directionsDisplay.setPanel(document.getElementById("directionsPanel"));

  google.maps.event.addListener(directionsDisplay, 'directions_changed', function() {
    setDestination();
  });
  setGolfMarker(strClubLat, strClubLng)
  calcRoute(myPos,golfPos);
  adjustScreen(31);
}

function setGolfMarker(lat, lng) {
  // Add markers to the map
  var image = new google.maps.MarkerImage('images/golf.png',
      new google.maps.Size(25, 25),
      new google.maps.Point(0,0),
      new google.maps.Point(0, 25));
  var shape = {
      coord: [1, 1, 1, 25, 25, 25, 25 , 1],
      type: 'poly'
  };
    var myLatLng = new google.maps.LatLng(lat, lng);
    golfMarker = new google.maps.Marker({
        position: myLatLng,
        map: map,
        icon: image,
        shape: shape,
        title: strClubNom,
        zIndex: 1
		});
		golfMarker.position_changed = stopGolfDrag;
}

function calcRoute(origin,destin) {

  var request = {
    origin: origin,
    destination: destin,
//    waypoints:[{location: "Bourke, NSW"}, {location: "Broken Hill, NSW"}],
    travelMode: google.maps.TravelMode.DRIVING
  };
  directionsService.route(request, function(response, status) {
    if (status == google.maps.DirectionsStatus.OK) {
      directionsDisplay.setDirections(response);
    }
  });
}

function setDestination() {

  document.getElementById("destCoord").innerHTML = golfMarker.getPosition();
  //directionsDisplay.directions.Mb.destination;
}


function showDetailItineraire(){
var detailWindow = window.open('trajet.html', 'trajet');

detailWindow.document.close();
}

function modifierTrajet(){
var modTrajetButton = document.getElementById('modTrajet');
var myDirect = directionsDisplay.directions.Mb

	if (modTrajetButton.innerHTML == 'Modifier'){
		modTrajetButton.innerHTML = 'Recalcul';
		directionsDisplay.setOptions({draggable: true});
		map.setCenter(myDirect.destination);
		map.setZoom(15);
		golfMarker.setOptions({draggable: true});
	}else{
		modTrajetButton.innerHTML = 'Modifier'
		calcRoute(myDirect.origin,myDirect.destination)
		directionsDisplay.setOptions({draggable: false});
		golfMarker.setOptions({draggable: false});
	}

}

function initPage(){
userId = GetCookie("userID");
var data = getURLdata();
var ids = data.split('$');
strClubLat = (ids[2]);
strClubLng = (ids[3]);
strClubNom = (ids[4]);

myPos = new google.maps.LatLng(ids[0],ids[1]);
golfPos = new google.maps.LatLng(strClubLat, strClubLng);


initialize();
}


	// -->
    </script> 
  </head>
<body onload="initPage()"><a name="haut"></a>
  
<div id="triButton">
<div id="duobutton"><a href="#" onclick="window.close(); return false;">Fermer</a>
<a id="modTrajet" href="javascript:modifierTrajet()" >Modifier</a>  
<a href="javascript:showDetailItineraire()">D&eacute;tail</a>
<div id="fontAdjust">
<div class="divFont" onclick="setFontSize(0.2, this)"><div class="divFontSize">A</div><div class="fontLogo">&#8593;</div></div>
<div class="divFont" onclick="setFontSize(-0.2, this)"><div class="divFontSize fontSmall">A</div><div class="fontLogo">&#8595;</div></div>
</div>
</div>

</div>

<div id="map_canvas"></div>

<div id="mapZoom">
<button class="boutonZoom" title="Zoom in" onclick="zoomMap(1); return false;">+</button>
<button class="boutonZoom" title="Zoom out" onclick="zoomMap(-1); return false;">-</button>
</div>

<div id="destCoord"></div>
<div id="directionsPanel"></div>

</body> 
</html>