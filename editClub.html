<!DOCTYPE html>
<html>
<head>
<meta content="yes" name="apple-mobile-web-app-capable" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta content="minimum-scale=1.0, width=device-width, maximum-scale=0.6667, user-scalable=no" name="viewport" />
<meta name="format-detection" content="telephone=yes" />

<link rel="shortcut icon" type="image/x-icon" href="images/golf.png">
<link rel="shortcut icon" type="image/x-icon" href="images/golf.png?">
<title>Golfs du Qu&eacute;bec</title>
<meta content="Golf GPS, Qu&eacute;bec, Canada, Golf du Qu&eacute;bec, Clubs de golf au Qu&eacute;bec, Qu&eacute;bec golf" name="keywords" />
<meta content="R&eacute;pertoire des clubs de golf du Qu&eacute;bec. GPS golf." name="description" />

<link href="misc/format.css" rel="stylesheet" media="screen" type="text/css" />

<script type="text/javascript" src="misc/util.js"></script>
<script type="text/javascript" language="Javascript">
<!--

var userId;
var clubID;
var courseIDdef;
var clubName;
var clubCourse;
var bloc;
var favChange = false;
var goURL;
var clubForm;
var newClub = {}, newCourse = {}, newBloc = {};
var indNewClub = false;
var delC = [], delB = [];
tmpID = 1000000;
const NORMALE = "Normale";
const ARRBLOCOPT = [NORMALE, "Hdcp", "Argent", "Blanc", "Bleu", "Bronze", "Cuivre", "Jaune", "Noir", "Or", "Orange", "Rose", "Rouge", "Vert"];

if (document.images)
{
 favOn= new Image(30,30);
 favOn.src="images/favoris.png";  

 favOff= new Image(30,30);
 favOff.src="images/favorisOff.png";
}

function initPage(){
clubForm = document.getElementById('clubForm');
var data = getURLdata();

setFontSize();

clubID = parseInt(data);
userId = GetCookie("userID");

getInfo("getClubParc?data=" + clubID + "$" + userId, showClub);

}


function showClub(oClubParc){

//Load club fields
clubForm.FclubName.value = oClubParc[0].nom;
clubForm.Fprive.checked = oClubParc[0].prive;
clubForm.Faddress.value = oClubParc[0].adresse;
clubForm.Fville.value = oClubParc[0].municipal;
clubForm.Fcopep.value = oClubParc[0].codepostal2;
clubForm.Ftel1.value = oClubParc[0].telephone;
clubForm.Ftel2.value = oClubParc[0].telephone2;
clubForm.Ftel3.value = oClubParc[0].telephone3;
clubForm.FurlClub.value = oClubParc[0].url_club;
clubForm.FurlMun.value = oClubParc[0].url_ville;
clubForm.Flong.value = oClubParc[0].longitude;
clubForm.Flat.value = oClubParc[0].latitude;
var reg = oClubParc[0].region;
for (var i = 0; i < clubForm.Freg.length; i++) {
	if (clubForm.Freg.options[i].value == reg)
		clubForm.Freg.selectedIndex = i;
}

var mapLink = document.getElementById('mapLink');
var CourseList = "";
clubCourse = (oClubParc[0].courses);
courseIDdef = oClubParc[0].courses[0]._id;
mapLink.href += clubID + "$" + courseIDdef;

for (var i = 0; i < clubCourse.length; i++) {
	CourseList += clubCourse[i]._id + "$";
}
CourseList = CourseList.substring(0, CourseList.length - 1 );
getInfo("getBloc?data=" + CourseList, showBlock);

if (oClubParc[0]._id == 2){	// New club
	tmpID++;
	clubID = tmpID;
	oClubParc[0]._id = clubID;
	clubCourse[0].CLUB_ID = tmpID;
	tmpID++;
	clubCourse[0]._id = tmpID;
	indNewClub = true;
}else{
	var labClub = document.getElementById('labClub');
	var butClub = document.getElementById('butClub');

	labClub.innerHTML = "Edit Club&nbsp;:&nbsp;&nbsp;&nbsp;";
	butClub.style.visibility = "visible";
}  

//Create course dropdown list
initCourses();
//Create newCourse object
saveCourse(newCourse);
//Show first course
showCourse();
}

function initCourses(isNew){
while (clubForm.Fparc.childNodes.length > 0){
	clubForm.Fparc.removeChild(clubForm.Fparc.childNodes[0]);
}
var selParc = document.getElementById('Fparc');
for (var p = 0; p < clubCourse.length; p++) {
	var optCode = "";
	var optElem = document.createElement("option");
	optElem.setAttribute('value', clubCourse[p]._id);
	var parcoursName = "";
	if (clubCourse[p].POINTS == "E")
		optCode += "Ex&eacute;cutif,&nbsp;";
	if (clubCourse[p].PARCOURS && clubCourse[p].PARCOURS != null && clubCourse[p].PARCOURS != "")
		optCode += clubCourse[p].PARCOURS + "&nbsp;" 
	if (clubCourse[p].TROUS)
		optCode += clubCourse[p].TROUS + langLbl["holes"];
	if (clubCourse[p].DEPUIS)	
		optCode += langLbl["since"] + clubCourse[p].DEPUIS ;
	if (clubCourse[p].NORMALE)
		optCode +=  langLbl["ccpar"] + clubCourse[p].NORMALE + ", &nbsp;" + clubCourse[p].VERGES + langLbl["cyard"];
	if (clubCourse[p].PARCOURS != "")
		parcoursName += " - " + clubCourse[p].PARCOURS;

	optElem.innerHTML = optCode;	
	selParc.appendChild(optElem);
}
if (isNew)
	selParc.selectedIndex = selParc.length -1;
return selParc;
}

function addClub(isAuto){
if (isAuto)
	document.location = "editClub.html?data=2";
else 
	if (confirm("Add a new club ? "))
		document.location = "editClub.html?data=2";
}

function delClub(){
if (confirm("Remove course « " + clubForm.FclubName.value + " » and all data ?")){
	var divCoor = document.getElementById("divCoor");
	var tipCoorTxt = document.getElementById("divCoorTxt")
		divCoor.style.visibility = 'visible';
		var msg = "&nbsp;<b>Deleting Club " + clubForm.FclubName.value + " ...</b>";
		tipCoorTxt.innerHTML = msg;
		getInfo("delClub?data=" + clubID , clubDeleted);
}
}

function clubDeleted(oRep){
if (oRep.ok){
	var tipCoorTxt = document.getElementById("divCoorTxt")
	tipCoorTxt.innerHTML = "&nbsp;<b>Club " + clubForm.FclubName.value + " deleted !</b>";
	fadeOut("divCoor",300);
	setTimeout(function() {
		addClub(true);
	}, 3000);
}
}

function saveAll(){
var divCoor = document.getElementById("divCoor");
var tipCoorTxt = document.getElementById("divCoorTxt")
var data = {}, oClub = {};
	divCoor.style.visibility = 'visible';
	var msg = "&nbsp;<b>Saving Club " + clubForm.FclubName.value + " ...</b>";
	tipCoorTxt.innerHTML = msg;
oClub.ID = clubID;
oClub.name = clubForm.FclubName.value;
oClub.prive = clubForm.Fprive.checked;
oClub.addr = clubForm.Faddress.value;
oClub.ville = clubForm.Fville.value;
oClub.codp = clubForm.Fcopep.value;
oClub.tel1 = clubForm.Ftel1.value;
oClub.tel2 = clubForm.Ftel2.value;
oClub.tel3 = clubForm.Ftel3.value;
oClub.urlc = clubForm.FurlClub.value;
oClub.urlv = clubForm.FurlMun.value; 
oClub.lng = eval(clubForm.Flong.value);
oClub.lat = eval(clubForm.Flat.value);
oClub.region = eval(clubForm.Freg.options[clubForm.Freg.selectedIndex].value);  //	clubForm.Freg.selectedIndex
	
	//Save current course
	for (var p = 0; p < clubCourse.length; p++){
		if (clubCourse[p]._id == clubForm.FPid.value){saveCourse(clubCourse[p]);}
	}
	//Save current bloc
	saveBloc(getCurrentBloc());
	
data.club = oClub;
data.course = clubCourse;
data.blocs = bloc;

getInfo("saveClub?data=" + JSON.stringify(data) , clubSaved);

}

function getCurrentBloc(){
	for (var p = 0; p < bloc.length; p++) {
		if (bloc[p]._id == clubForm.FBid.value){
			 return bloc[p]; break;}
	}
}

function clubSaved(oRes){
var tipCoorTxt = document.getElementById("divCoorTxt");

if (!oRes.ok && oRes.message){
	var modLayer = document.getElementById('modalDiv');
	alert(langLbl[oRes.message]);
	authentifier();
	modLayer.style.visibility="visible";
}else{
	if (oRes.upserted)
		var msg = "&nbsp;<b>Club " + clubForm.FclubName.value + " : <strong>ADDED</strong></b></br>" ;
	else
		var msg = "&nbsp;<b>Club " + clubForm.FclubName.value + " : " + ((oRes.nModified == 0) ? 'UNCHANGED':'<strong>UPDATED</strong>') + " </b></br>" ;
	
	tipCoorTxt.innerHTML = msg;
	var resCour = oRes.courses;
	var resBloc = oRes.blocs;
	for (var p = 0; p < resCour.length; p++){	// For each course
		msg += "&nbsp;&nbsp;<b>Course " + clubCourse[p].PARCOURS + " " + clubCourse[p].VERGES + " verges : " ;
		if (resCour[p].oldID){
			var oldID = resCour[p].oldID;
			var newID = resCour[p].newID;
			for (var i = 0; i < clubCourse.length; i++){	// Change course _id = oldID
				if ( clubCourse[i]._id == oldID){
					clubCourse[i]._id = newID;
					if (clubForm.FPid.value == oldID)
						clubForm.FPid.value = newID;
				}		
			}
			for (var i = 0; i < bloc.length; i++){	// Change course _id = oldID
				if ( bloc[i].PARCOURS_ID == oldID){
					bloc[i].PARCOURS_ID = newID;
				}		
			}
			msg += " <strong>ADDED</strong></b></br>" ;
		}else{
			msg += ((oRes.courses[p].result.nModified == 0) ? 'UNCHANGED':'<strong>UPDATED</strong>') + " </b></br>" ;
		}
		// Check blocs
		for (var jj = 0; jj < bloc.length; jj++){	
			for (var j = 0; j < resBloc.length; j++){
				if ( bloc[jj].PARCOURS_ID == resCour[p].result._id ){	// Current course 
				if ( (resBloc[j].result._id.$oid && bloc[jj]._id == resBloc[j].result._id.$oid) || 
					 (bloc[jj]._id == resBloc[j].result._id) || 
					 (resBloc[j].oldID && bloc[jj]._id == resBloc[j].oldID )){
					msg += "&nbsp;&nbsp;&nbsp;&nbsp;<b>Bloc " + bloc[jj].Bloc + ", Total = " + bloc[jj].Total ;
					if (resBloc[j].newID){
						bloc[jj]._id = resBloc[j].newID;
						if (clubForm.FBid.value == resBloc[j].oldID)
							clubForm.FBid.value = resBloc[j].newID;						
						msg += " <strong>ADDED</strong></b></br>" ;
					}else{
						msg += ((resBloc[j].result.nModified == 0) ? ' : UNCHANGED':'<strong> : UPDATED</strong>') + " </b></br>" ;
					}
					break;
				}}
			}
		}
		var pos = delB.indexOf(clubCourse[p]._id);
		if (pos != -1)
			for (var x = 0; x < delB.length; x+=3){
				if (delB[x] == clubCourse[p]._id)
					msg += "&nbsp;&nbsp;&nbsp;&nbsp;<b>Bloc " + delB[x+1] + ", Total = " + delB[x+2] + " <strong> REMOVED</strong></b></br>";
			}
			
	}
	for (var x = 0; x < delC.length; x+=3){
		msg += "&nbsp;&nbsp;<b>Course " + delC[x+1] + " " + delC[x+2] + " verges<strong> REMOVED</strong></b></br>";
	}	
	tipCoorTxt.innerHTML = msg;
	fadeOut("divCoor",300);
	delC = [];
	delB = [];
	if (oRes.upserted)
		setTimeout(function() {
			document.location = "editClub.html?data=" + oRes.upserted;
		}, 3000);
}
}

function addParc(){
clubCourse[clubCourse.length] = JSON.parse(JSON.stringify(newCourse));
clubForm.FPtype.value = "";
clubForm.FPname.value = "New course";
clubForm.FPdep.value = "";
clubForm.FPtrous.value = "18";
clubForm.FPnorm.value = "72";
clubForm.FPverg.value = "6000";
tmpID++;
clubCourse[clubCourse.length-1]._id = tmpID;
clubCourse[clubCourse.length-1].GPS = false;
clubForm.FPid.value = tmpID;
saveCourse(clubCourse[clubCourse.length-1]);
parcList = initCourses(true);
addBloc(NORMALE);
showCourse(parcList);
}

function addBloc(blocName){
//saveBloc(getCurrentBloc());
bloc[bloc.length] = JSON.parse(JSON.stringify(newBloc));
bloc[bloc.length-1].PARCOURS_ID = clubForm.FPid.value;
tmpID++;
clubForm.FBid.value = tmpID;
bloc[bloc.length-1]._id = tmpID;
if (blocName)
	bloc[bloc.length-1].Bloc = blocName;
initBlocs();
}

function delCourse(){
var cname = clubForm.Fparc.options[clubForm.Fparc.selectedIndex].innerHTML;
cname = cname.replace(/&nbsp;/g, " ");
if (clubForm.Fparc.options.length < 2)
	alert("Can't remove last course.");
else
if (confirm("Remove course « " + cname + " » and all blocs ?")){
	var ind = (clubForm.FPid.value);
	for (var p = 0; p < clubCourse.length; p++){
		if (clubCourse[p]._id == ind){
			delC[delC.length] = clubCourse[p]._id;
			delC[delC.length] = clubCourse[p].PARCOURS;
			delC[delC.length] = clubCourse[p].VERGES;
			clubCourse.splice(p,1);
			clubForm.Fparc.removeChild(clubForm.Fparc.options[clubForm.Fparc.selectedIndex]);
			break;
			}
	}
	showCourse();
	initBlocs();
	showBloc();
}
}

function delBloc(){
if (clubForm.FBbloc.options.length < 2)
	alert("Can't remove last bloc.");
else
if (confirm("Remove bloc « " + clubForm.FBbloc.options[clubForm.FBbloc.selectedIndex].innerHTML + " » ?")){
	var ind = clubForm.FBid.value;
	if (ind.length < 9)
		ind = eval(clubForm.FBid.value);
	for (var p = 0; p < bloc.length; p++){
		if (bloc[p]._id == ind){
			delB[delB.length] = bloc[p].PARCOURS_ID;
			delB[delB.length] = bloc[p].Bloc;
			delB[delB.length] = bloc[p].Total;
			bloc.splice(p,1);
			break;
			}
	}
	initBlocs();
	showBloc();
}
}

function saveCourse(curParc){
	curParc.CLUB_ID = clubID;
	curParc._id = eval(clubForm.FPid.value);
	curParc.POINTS = clubForm.FPtype.value;
	curParc.PARCOURS = clubForm.FPname.value;
	curParc.DEPUIS = clubForm.FPdep.value;
	curParc.TROUS = eval(clubForm.FPtrous.value);
	curParc.NORMALE = eval(clubForm.FPnorm.value);
	curParc.VERGES = eval(clubForm.FPverg.value);
}

function showCourse(parcList){
//alert(parcList);
if (parcList){  // On course change Save course and show new
	for (var p = 0; p < clubCourse.length; p++){
		if (clubCourse[p]._id == clubForm.FPid.value){saveCourse(clubCourse[p]);}
	}
	var ind = parcList.selectedIndex;
}else
	var ind = 0;

clubForm.FPid.value = clubCourse[ind]._id;
newBloc.PARCOURS_ID = eval(clubForm.FPid.value);
clubForm.FPtype.value = clubCourse[ind].POINTS;
clubForm.FPname.value = clubCourse[ind].PARCOURS;
clubForm.FPdep.value = clubCourse[ind].DEPUIS;
clubForm.FPtrous.value = clubCourse[ind].TROUS;
clubForm.FPnorm.value = clubCourse[ind].NORMALE;
clubForm.FPverg.value = clubCourse[ind].VERGES;
if (parcList){  //Change course init blocs
	initBlocs();
	showBloc();
}  
}


function saveBloc(curBloc){

	curBloc.PARCOURS_ID = eval(clubForm.FPid.value);
	curBloc.T1 = clubForm.FBt1.value;
	curBloc.T2 = clubForm.FBt2.value;
	curBloc.T3 = clubForm.FBt3.value;
	curBloc.T4 = clubForm.FBt4.value;
	curBloc.T5 = clubForm.FBt5.value;
	curBloc.T6 = clubForm.FBt6.value;
	curBloc.T7 = clubForm.FBt7.value;
	curBloc.T8 = clubForm.FBt8.value;
	curBloc.T9 = clubForm.FBt9.value;
	curBloc.T10 = clubForm.FBt10.value;
	curBloc.T11 = clubForm.FBt11.value;
	curBloc.T12 = clubForm.FBt12.value;
	curBloc.T13 = clubForm.FBt13.value;
	curBloc.T14 = clubForm.FBt14.value;
	curBloc.T15 = clubForm.FBt15.value;
	curBloc.T16 = clubForm.FBt16.value;
	curBloc.T17 = clubForm.FBt17.value;
	curBloc.T18 = clubForm.FBt18.value;
	curBloc.Aller = clubForm.FBtoto.value;
	curBloc.Retour = clubForm.FBtoti.value;
	curBloc.Total = clubForm.FBtota.value;
	curBloc.Eval = clubForm.FBeval.value;
	curBloc.Slope = clubForm.FBslope.value;
}

function showBloc(oBlocsList){
if (typeof oBlocsList == "object"){  // On bloc change Save current bloc and show new
	saveBloc(getCurrentBloc());
	clubForm.FBid.value = oBlocsList.options[oBlocsList.selectedIndex].value;
}
var blocID = clubForm.FBid.value;
for (var p = 0; p < bloc.length; p++) {
	if (bloc[p]._id == blocID){
		//alert(bloc[p].Bloc);
		clubForm.FBt1.value = bloc[p].T1;
		clubForm.FBt2.value = bloc[p].T2;
		clubForm.FBt3.value = bloc[p].T3;
		clubForm.FBt4.value = bloc[p].T4;
		clubForm.FBt5.value = bloc[p].T5;
		clubForm.FBt6.value = bloc[p].T6;
		clubForm.FBt7.value = bloc[p].T7;
		clubForm.FBt8.value = bloc[p].T8;
		clubForm.FBt9.value = bloc[p].T9;
		clubForm.FBt10.value = bloc[p].T10;
		clubForm.FBt11.value = bloc[p].T11;
		clubForm.FBt12.value = bloc[p].T12;
		clubForm.FBt13.value = bloc[p].T13;
		clubForm.FBt14.value = bloc[p].T14;
		clubForm.FBt15.value = bloc[p].T15;
		clubForm.FBt16.value = bloc[p].T16;
		clubForm.FBt17.value = bloc[p].T17;
		clubForm.FBt18.value = bloc[p].T18;
		clubForm.FBtoto.value = bloc[p].Aller;
		clubForm.FBtoti.value = bloc[p].Retour;
		clubForm.FBtota.value = bloc[p].Total;
		clubForm.FBeval.value = bloc[p].Eval;
		clubForm.FBslope.value = bloc[p].Slope;
		break; 
	}
}
if (typeof oBlocsList == "number")
	clubForm.FBbloc.selectedIndex = oBlocsList;
}

function initBlocs(){
var parcID = clubForm.FPid.value;
while (clubForm.FBbloc.childNodes.length > 0){
	clubForm.FBbloc.removeChild(clubForm.FBbloc.childNodes[0]);
}
for (var p = 0; p < bloc.length; p++) {
	if (bloc[p].PARCOURS_ID == parcID){
		//alert(bloc[p].Bloc);
		bloc[p]._id = (bloc[p]._id.$oid) ? bloc[p]._id.$oid : bloc[p]._id;
		var optElem = document.createElement("option");
		optElem.setAttribute('value', bloc[p]._id);
		optElem.innerHTML = bloc[p].Bloc;
		clubForm.FBbloc.appendChild(optElem);
		if (!bloc[p].Bloc)
			selNewBloc();
	}
}
clubForm.FBid.value = clubForm.FBbloc.options[clubForm.FBbloc.selectedIndex].value;
}

function showBlock(oBlock){
//Create newBloc object
saveBloc(newBloc);
//Load first course fields
bloc = oBlock;
var nextCourse = 0;
if (indNewClub){
	bloc[0].PARCOURS_ID = clubCourse[0]._id;
	tmpID++;
	bloc[0]._id = tmpID;
}
	
initBlocs();
showBloc();

// Course list
var pageZone = document.getElementById('pageZone');
if (bloc.length > 0){
for (var p = 0; p < clubCourse.length; p++) {
	var htmlCode = "";
	var courseID = clubCourse[p]._id;
	//var bloc = oBlock[p];
	var b = 0;
	while (bloc[b] && bloc[b].PARCOURS_ID != courseID) {
		b++;
	}
	
	nextCourse = b;
	//Bloc list
	if (bloc[b]){
		var nbrTrou = clubCourse[p].TROUS;

		var liElem = document.createElement("li");
		liElem.setAttribute('class', 'listitem gras');
		var divElem = document.createElement("div");
		divElem.setAttribute('id', 'p1');
		divElem.setAttribute('class', 'cartePts');

		var htmlCode = '<table class="cartePts"><tr><td  class="titre" colspan="14"><b>' + langLbl["cours"] + clubCourse[p].PARCOURS + "&nbsp;" + nbrTrou + langLbl["holes"] + '</b></td></tr>';
		if(nbrTrou == 9)
			htmlCode += '<tr class="entete"><th>' + langLbl["hole"] + '</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th><th>Total</th></tr>';
		else
			htmlCode += '<tr class="entete"><th>' + langLbl["hole"] + '</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th><th>' + langLbl["goout"] + '</th><td></td><td></td><td></td></tr>';

		
		do{
			var cName = 'B' + bloc[b].Bloc;
			htmlCode += '<tr><td class="' + cName + '">' + langLbl[bloc[b].Bloc] + '</td>';
			for (var i = 1; i < 10; i++) {
				var x = "bloc[b].T" + i;
				htmlCode += '<td class="' + cName + '">' + eval(x) + '</td>';
			}
			if(nbrTrou == 9)
				htmlCode += '<td class="' + cName + '">' + ((bloc[b].Aller == null) ? "":bloc[b].Aller) + '</td>';
			else
				htmlCode += '<td class="' + cName + '">' + ((bloc[b].Aller == null) ? "":bloc[b].Aller) + '</td><td></td><td></td><td></td>';
		b += 1;
		} while ( bloc[b] && bloc[b].PARCOURS_ID == courseID);

		if(nbrTrou == 18){
			htmlCode += '<tr class="entete"><th>' + langLbl["hole"] + '</th><th>10</th><th>11</th><th>12</th><th>13</th><th>14</th><th>15</th><th>16</th><th>17</th><th>18</th><th>' + langLbl["goin"] + '</th><th>Total</th><th>Eval.</th><th>Slope</th></tr>';
			var b = nextCourse;
			do{
				var cName = 'B' + bloc[b].Bloc;
				htmlCode += '<tr><td class="' + cName + '">' + langLbl[bloc[b].Bloc] + '</td>';
				for (var i = 10; i < 19; i++) {
					var x = "bloc[b].T" + i;
					htmlCode += '<td class="' + cName + '">' + eval(x) + '</td>';
				}
				htmlCode += '<td class="' + cName + '">' + ((bloc[b].Retour == null) ? "":bloc[b].Retour) + '</td><td class="' + cName + '">' + ((bloc[b].Total == null) ? "":bloc[b].Total) + '</td><td class="' + cName + '">' + bloc[b].Eval + '</td><td class="' + cName + '">' + bloc[b].Slope + '</td>';
			b += 1;
			} while ( bloc[b] && bloc[b].PARCOURS_ID == courseID);
		}
		nextCourse = b;
		htmlCode += '</table>';
		divElem.innerHTML = htmlCode;
		liElem.appendChild(divElem);
		pageZone.appendChild(liElem);
	}
}
}
showProgress(1);
}

function selNewBloc(){
var modLayer = document.getElementById('modalDiv');
var prefLayer = document.getElementById('prefLayer');
var FselBloc = document.getElementById('FselBloc');
var parcID = clubForm.FPid.value;
var arrOpt = ARRBLOCOPT.slice();

while (FselBloc.childNodes.length > 0){
	FselBloc.removeChild(FselBloc.childNodes[0]);
}
for (var p = 0; p < bloc.length; p++) {
	if (bloc[p].PARCOURS_ID == parcID){
		value = bloc[p].Bloc;
		if (value && value != NORMALE && value != "Hdcp")
			arrOpt.splice(arrOpt.indexOf(value),1);
	}
}
for (var i = 0; i < arrOpt.length; i++) {
		var optElem = document.createElement("option");
		optElem.setAttribute('value', arrOpt[i]);
		optElem.innerHTML = arrOpt[i];
		FselBloc.appendChild(optElem);
}
modLayer.style.visibility="visible";
prefLayer.style.visibility="visible";
}

function selBloc(){
var modLayer = document.getElementById('modalDiv');
var prefLayer = document.getElementById('prefLayer');
var FselBloc = document.getElementById('FselBloc');

if (FselBloc.selectedIndex  < 0)
	alert("Select a value then click Ok");
else{
	bloc[bloc.length-1].Bloc = FselBloc.options[FselBloc.selectedIndex].value;
	initBlocs();
	clubForm.FBid.value = clubForm.FBbloc.options[clubForm.FBbloc.length - 1].value;
	showBloc(clubForm.FBbloc.length - 1);
	prefLayer.style.visibility="hidden";
	modLayer.style.visibility="hidden";
}
}

function addToBlocks(fBloc){
var tTab = fBloc.tabText.value;
var dat = tTab.split("\n");

for (var i = 0; i < dat.length; i++) {
	var bData = dat[i];
	var t = bData[0].charCodeAt(0);
	bData = bData.split("\t");
	if (! (t>= 48 && t<=57)){	//Not numeric
		var bName = bData[0];
		if (ARRBLOCOPT.indexOf(bName) == -1){
			alert(bName + " nor avalaible in bloc options list. ");
			continue;
		}
		if (bName == NORMALE){
			clubForm.FBbloc.selectedIndex = 0;
			clubForm.FBid.value = clubForm.FBbloc[0].value;
		}else{
			addBloc(bName);
			clubForm.FBbloc.selectedIndex = clubForm.FBbloc.options.length - 1;
			clubForm.FBid.value = clubForm.FBbloc.options[clubForm.FBbloc.selectedIndex].value;
			showBloc();
		}
		bData.splice(0,1);
	}
	addToBlock(bData);
	saveBloc(getCurrentBloc());
}
}

function addToBlock(dat){
//var tTab = fBloc.tabText.value;
//var dat = bDat.split("\t");
var adj = 1;
for (var i = 0; i < dat.length; i++) {
	var oF = eval("clubForm.FBt" + (i + adj) )
	if (i == 9){
		oF = clubForm.FBtoto ;
		adj--;
		}
	if (i == 19)
		oF = clubForm.FBtoti ;
	if (i == 20)
		oF = clubForm.FBtota ;
	if (i == 21)
		oF = clubForm.FBeval ;
	if (i == 22)
		oF = clubForm.FBslope ;
	oF.value = dat[i];
}
}

// -->
</script>

<style>

.formLabel{
position: relative;
float: left;
clear: both;
width: 200px;
display: inline;
text-align: right;
margin-right: 1em;
}

.inputselect {
height: auto;
}

#butMenu {
    visibility: visible;
	margin-left: 10px;
}

.sectionTitle{
margin-left: 10px;
font-weight: bold;
font-size: 1.1em;
}

.tipCoor .tipCoorTxt{
	position: absolute;
	top: 70px;
	left: 1%;
	/*background:white;
	visibility:hidden;*/
	padding: 5px;
	background-color: #777;
	border-radius: 6px;
	color: #eee;
}

.tipCoor .tipCoorTxt::after {
    content: "";
    position: absolute;
    top: -0.8em;
    left: 1em;
    margin-left: -5px;
    border-width: 10px;
    border-style: solid;
    border-color: transparent transparent #777 transparent;
}

#divCoor, #butClub{
visibility: hidden;
display: inline;
}

strong{
color: #0f0;
}

</style>

</head>

<body onload="initPage()"><a name="haut"></a>

<div id="topbar" class="vert">
<div id="leftnav"><a title="Formulaire de recherche" href="index.html"><img alt="Formulaire de recherche" height="22" width="25" src="images/home22.png" /></a></div>
<div id="chargement" class="">
<progress id="progressQ" ></progress>
<div class="charge"><text id="load"></text></div><div class="charge loading"></div></div>
<div id="fontAdjust" class="unselectable">
<div class="divFont" onclick="setFontSize(0.2, this)"><div class="divFontSize">A</div><div class="fontLogo">&#8593;</div></div>
<div class="divFont" onclick="setFontSize(-0.2, this)"><div class="divFontSize fontSmall">A</div><div class="fontLogo">&#8595;</div></div>
</div>
</div>
<div id="duobutton">
<a href="#" id="butMenu" title="Save data" onclick="saveAll();"><img id="logosave" alt="Menu" src="images/save.png" height="32"></a>
<a href="listeResult.html" ><text id="mlist"></text></a>
<a id="mapLink" target="_blank" href="ClubMap.html?data=" ><text id="mmaps"></text></a>
</div>


<div id="content">



<ul id="pageZone" class="pageitem">
<form id="clubForm" action="javascript:void(0);">

	<div class="sectionTitle">
	<label id="labClub">Add Club&nbsp;:&nbsp;&nbsp;&nbsp;</label>
	<div id="butClub">
	<a class="itin" alt="Add club" href="javascript:addClub();">Add club</a>
	<a class="itin" alt="Remove club" href="javascript:delClub();">Remove club</a>
	</div></div>
<li class="listitem gras">
	<div class="formLabel">	
	<label for="FclubName">Club name</label></div>
	<input id="FclubName" class="inputtext" type="text" size="20" maxlength="25" value=""/>
</li>
<li class="listitem gras">
	<div class="formLabel">	
	<label for="Fprive">Privé</label></div>
	<input id="Fprive" class="inputtext" type="checkbox" />
</li>
<li class="listitem gras">
	<div class="formLabel">
	<label for="Freg"><text id="region">R&eacute;gion</text></label></div>
	<select id="Freg" class="inputselect">
		<option value="1">Abitibi</option>
		<option value="2">Appalaches</option>
		<option value="3">Côte-Nord</option>
		<option value="4">Centre Québec</option>
		<option value="5">Estrie</option>
		<option value="6">Gaspésie</option>
		<option value="7">Lanaudière</option>
		<option value="8">Laurentides</option>
		<option value="9">Laval</option>
		<option value="10">Mauricie</option>
		<option value="11">Montréal</option>
		<option value="12">Montérégie</option>
		<option value="13">Outaouais</option>
		<option value="14">Québec</option>
		<option value="15">Saguenay</option>
		<option value="16">Valleyfield</option>
		<option value="17">PGA est</option>
		<option value="18">PGA ouest</option>	
	</select>
</li>
<li class="listitem gras">
	<div class="formLabel">
	<label for="Faddress">Address</label></div>
	<input id="Faddress" class="inputtext" type="text" size="20" maxlength="25" value=""/>
</li>
<li class="listitem gras">
	<div class="formLabel">
	<label for="Fville">Ville</label></div>
	<input id="Fville" class="inputtext" type="text" size="20" maxlength="25" value=""/>
</li>
<li class="listitem gras">
	<div class="formLabel">
	<label for="Fcopep">Code postal</label></div>
	<input id="Fcopep" class="inputtext" type="text" size="7" maxlength="7" value=""/>
</li>
<li class="listitem gras">
	<div class="formLabel">
	<label for="Ftel1">Téléphone 1</label></div>
	<input id="Ftel1" class="inputtext" type="text" size="12" maxlength="12" value=""/>
</li>	
<li class="listitem gras">
	<div class="formLabel">
	<label for="Ftel2">Téléphone 2</label></div>
	<input id="Ftel2" class="inputtext" type="text" size="12" maxlength="12" value=""/>
</li>
<li class="listitem gras">
	<div class="formLabel">
	<label for="Ftel3">Téléphone 3</label></div>
	<input id="Ftel3" class="inputtext" type="text" size="12" maxlength="12" value=""/>
</li>
<li class="listitem gras">
	<div class="formLabel">
	<label for="FurlClub">url Club</label></div>
	<input id="FurlClub" class="inputtext" type="text" size="25" maxlength="80" value=""/>
</li>
<li class="listitem gras">
	<div class="formLabel">
	<label for="FurlMun">url Municipalité</label></div>
	<input id="FurlMun" class="inputtext" type="text" size="25" maxlength="80" value=""/>
</li>
<li class="listitem gras">
	<div class="formLabel">
	<label for="Flong">Longitude</label></div>
	<input id="Flong" class="inputtext" type="text" size="12" maxlength="12" value=""/>
</li>
<li class="listitem gras">
	<div class="formLabel">
	<label for="Flat">Latitude</label></div>
	<input id="Flat" class="inputtext" type="text" size="12" maxlength="12" value=""/>
</li>

<hr>
<!-- Course list // -->
	<div class="sectionTitle">
	<label for="Fparc">Courses&nbsp;:&nbsp;&nbsp;</label><a class="itin" alt="Add course" href="javascript:addParc();">Add course</a>
	<a class="itin" alt="Add course" href="javascript:delCourse();">Remove course</a></div>
	<select id="Fparc" class="inputselect" onchange="showCourse(this)">
	</select>
	
	
 <table>
  <thead>
  <input id="FPid" type="hidden" value=""/>
  <tr>
     <th>Type</th>
     <th>Name</th>
     <th>Depuis</th>
     <th>Trous</th>
     <th>Par</th>
     <th>Verges</th>
  </tr>
  </thead>
  <tbody>
  <tr>
     <td><input id="FPtype" class="inputtext" type="text" size="3" maxlength="3" value=""/></td>
     <td><input id="FPname" class="inputtext" type="text" size="20" maxlength="30" value=""/></td>
	 <td><input id="FPdep" class="inputtext" type="text" size="4" maxlength="4" value=""/></td>
	 <td><input id="FPtrous" class="inputtext" type="text" size="2" maxlength="2" value=""/></td>
	 <td><input id="FPnorm" class="inputtext" type="text" size="2" maxlength="2" value=""/></td>
	 <td><input id="FPverg" class="inputtext" type="text" size="4" maxlength="4" value=""/></td>
  </tr>
  </tbody>
</table> 
<hr>
<!-- Blocs list // -->	
	<div class="sectionTitle">
	<label for="FBbloc">Blocs&nbsp;:&nbsp;&nbsp;</label><a class="itin" alt="Add course" href="javascript:addBloc();">Add bloc</a>
	<a class="itin" alt="Add course" href="javascript:delBloc();">Remove bloc</a></div>
	<select id="FBbloc" class="inputselect" onchange="showBloc(this)">
<!--<option value="Normale">Par</option>
<option value="HDCP">HDCP</option>
<option value="Argent">Argent</option>
<option value="Blanc">Blanc</option>
<option value="Bleu">Bleu</option>
<option value="Bronze">Bronze</option>
<option value="Cuivre">Cuivre</option>
<option value="Jaune">Jaune</option>
<option value="Noir">Noir</option>
<option value="Or">Or</option>
<option value="Orange">Orange</option>
<option value="Rose">Rose</option>
<option value="Rouge">Rouge</option>
<option value="Vert">Vert</option>// -->
	</select>
<table>
  <thead>
  <input id="FBid" type="hidden" value=""/>
  <tr>
     <th>1</th>
     <th>2</th>
     <th>3</th>
     <th>4</th>
     <th>5</th>
     <th>6</th>
     <th>7</th>
     <th>8</th>
     <th>9</th>
     <th>T. out</th>
     <th></th>
     <th></th>
     <th></th>
  </tr>
  </thead>
  <tbody>
  <tr>
     <td><input id="FBt1" class="inputtext" type="text" size="2" maxlength="3" value=""/></td>
	 <td><input id="FBt2" class="inputtext" type="text" size="2" maxlength="3" value=""/></td>
	 <td><input id="FBt3" class="inputtext" type="text" size="2" maxlength="3" value=""/></td>
	 <td><input id="FBt4" class="inputtext" type="text" size="2" maxlength="3" value=""/></td>
	 <td><input id="FBt5" class="inputtext" type="text" size="2" maxlength="3" value=""/></td>
     <td><input id="FBt6" class="inputtext" type="text" size="2" maxlength="3" value=""/></td>
	 <td><input id="FBt7" class="inputtext" type="text" size="2" maxlength="3" value=""/></td>
	 <td><input id="FBt8" class="inputtext" type="text" size="2" maxlength="3" value=""/></td>
	 <td><input id="FBt9" class="inputtext" type="text" size="2" maxlength="3" value=""/></td>
	 <td><input id="FBtoto" class="inputtext" type="text" size="3" maxlength="4" value=""/></td>
	 <td></td>
     <td></td>
     <td></td>
  </tr>
  </tbody>
  <thead>
  <tr>
     <th>10</th>
     <th>11</th>
     <th>12</th>
     <th>13</th>
     <th>14</th>
     <th>15</th>
     <th>16</th>
     <th>17</th>
     <th>18</th>
     <th>T. in</th>
     <th>Total</th>
     <th>Eval.</th>
     <th>Slope</th>
  </tr>
  </thead>
  <tbody>
  <tr>
     <td><input id="FBt10" class="inputtext" type="text" size="2" maxlength="3" value=""/></td>
	 <td><input id="FBt11" class="inputtext" type="text" size="2" maxlength="3" value=""/></td>
	 <td><input id="FBt12" class="inputtext" type="text" size="2" maxlength="3" value=""/></td>
	 <td><input id="FBt13" class="inputtext" type="text" size="2" maxlength="3" value=""/></td>
	 <td><input id="FBt14" class="inputtext" type="text" size="2" maxlength="3" value=""/></td>
	 <td><input id="FBt15" class="inputtext" type="text" size="2" maxlength="3" value=""/></td>
     <td><input id="FBt16" class="inputtext" type="text" size="2" maxlength="3" value=""/></td>
	 <td><input id="FBt17" class="inputtext" type="text" size="2" maxlength="3" value=""/></td>
	 <td><input id="FBt18" class="inputtext" type="text" size="2" maxlength="3" value=""/></td>
	 <td><input id="FBtoti" class="inputtext" type="text" size="3" maxlength="4" value=""/></td>
	 <td><input id="FBtota" class="inputtext" type="text" size="3" maxlength="4" value=""/></td>
	 <td><input id="FBeval" class="inputtext" type="text" size="3" maxlength="4" value=""/></td>
     <td><input id="FBslope" class="inputtext" type="text" size="3" maxlength="4" value=""/></td>
  </tr>
  </tbody>
</table> 
</form>

<form id="tabTextF">
	​<textarea id="tabText" rows="4" cols="100" form="tabTextF"></textarea>
	<input id="butAddBloc" type="button" onclick="addToBlocks(this.form);" value="Add text tab delimited above to current block"/>
</form>

</ul>





</div>

<div id="bottombar" class="vert">
	<div id="rightbutton"> <a href="#haut"><img alt="Haut de page" src="images/haut.png" /></a> </div>
	<div id="message"></div>
</div>

<div id="copyright">
<a href="mailto:cdore00@yahoo.ca?Subject=Golfs%20du%20Qu&eacute;bec">Copyright &copy; 2005-2018</a>
</div>


<div id="divCoor" class="tipCoor"><span id="divCoorTxt" class="tipCoorTxt"></span></div>
<div id="modalDiv"></div>
<div id="authLayer"></div>
<div id="prefLayer">
<form>
	<select id="FselBloc" class="inputselect" size="12">
	</select>
</form>
	<div><a class="itin" alt="Add course" href="javascript:selBloc();">&nbsp;&nbsp;&nbsp;&nbsp;Ok&nbsp;&nbsp;&nbsp;&nbsp;</a></div>
</div>

</body>

</html>